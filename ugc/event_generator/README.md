Генератор событий
=================

Описание
--------

Генератор событий имитирует работу кинотеатра. Создаются два набора: фильмы и пользователи. Каждую секунду из обоих наборов случайное количество пользователей просматривает такое же количество фильмов. Событие представляет собой словарь вида

```python
{
    "key": str,
    "value": int
}
```
где

`key` - это строка вида **id_фильма**+**id_пользователя**, например `2dc0eed6-125c-4f4c-b4d5-3f498684791c+3e8ba5af-7cd6-4e7d-9d46-da12f9752058`

`value` - порядковый номер просмотренной секунды от начала фильма

POST-запросы с событием отправляются на URL-адрес, заданный в параметрах запуска.


Запуск
-----------------
Установите переменную окружения `API_JWT` (например в файле **.env**) -- это ключ авторизации для сервиса UGC.

Запуск выполняется в формате

```shell
python generate.py [-h] [--host HOST] [--batch BATCH] DATATYPE{views,content}
```

где

`--host` - схема и адрес хоста, на который отправляются POST-запросы генератора, по умолчанию http://localhost  
`--batch` - максимальное количество событий в пачке, по умолчанию равен 5
`datatype` - тип данных, `views` или `content`.

Ручной тест отправки
--------------------

Чтобы убедиться, что генератор действительно отсылает данные, выполните:

```shell
python main.py --host http://127.0.0.1:8080 --batch 1000 views
```

а в другом терминале:
```shell
python srv.py
```
